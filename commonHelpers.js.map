{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst formSearch = document.querySelector('.form-search');\nconst gallery = document.querySelector('.gallery');\nconst searchInput = document.querySelector('.picture-search-name');\nconst loaderContainer = document.querySelector('.loader-container');\nconst loadMoreButton = document.querySelector('.load-more-button');\nconst lightbox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 });\n\n\nlet currentPage = 1;\nconst perPage = 40;\nlet searchQuery = '';\n\nfunction showLoader() {\n  loaderContainer.style.display = 'block';\n}\nfunction removeLoader() {\n  loaderContainer.style.display = 'none';\n}\n\nasync function searchImages(query, currentPage) {\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"41511305-1e730bfa7be67778e89c40f75\";\n\n  const requestParams = {\n    key: API_KEY,\n    q: searchQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: currentPage,\n    per_page: perPage,\n  };\n\n  const searchParams = new URLSearchParams(requestParams);\n\n  showLoader();\n\ntry {\nconst response = await axios.get(`${BASE_URL}?${searchParams}`);\n\nconst { hits, totalHits } = response.data;\nif (hits.length === 0) {\n  loadMoreButton.style.display = 'none';\n  iziToast.warning({\n    title: 'Warning',\n    message: \"No results found for the given query.\",\n    position: 'topRight',\n  });\n  return;\n}\n\nconst galleryHtml = hits.reduce(\n      (html, image) =>\n        html +\n        `<a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n            <img\n                class=\"gallery-image\"\n                src=\"${image.webformatURL}\"\n                alt=\"${image.tags}\"\n            />\n           <ul class=\"info-list\">\n              <li class=\"info-item\">\n                  <p class=\"info-title\">Likes</p>\n                  <p class=\"info-value\">${image.likes}</p>\n              </li>\n              <li class=\"info-item\">\n                  <p class=\"info-title\">Views</p>\n                  <p class=\"info-value\">${image.views}</p>\n              </li>\n              <li class=\"info-item\">\n                  <p class=\"info-title\">Comments</p>\n                  <p class=\"info-value\">${image.comments}</p>\n              </li>\n              <li class=\"info-item\">\n                  <p class=\"info-title\">Downloads</p>\n                  <p class=\"info-value\">${image.downloads}</p>\n              </li>\n            </ul>\n        </a>`,\n      ''\n    );\n\n    gallery.insertAdjacentHTML('beforeend', galleryHtml);\n\n    lightbox.refresh();\n    loadMoreButton.style.display = 'block';\n\n    const scrollImages = document\n      .querySelector('.gallery-link')\n      .getBoundingClientRect().height;\n    window.scrollBy({\n      top: scrollImages * 2,\n      behavior: 'smooth',\n    });\n    if (currentPage * perPage >= totalHits) {\n      loadMoreButton.style.display = 'none';\n      iziToast.error({\n        title: 'Error',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n  } \n  \n  catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: error.message,\n      position: 'topRight',\n    });\n  }\n  finally {\n    removeLoader();\n  }\n}\n\nformSearch.addEventListener('submit', event => {\n  event.preventDefault();\n  gallery.innerHTML = ''; \n  searchQuery = searchInput.value.trim();\n  currentPage = 1;\n  loadMoreButton.style.display = 'none';\n  searchImages(searchQuery, currentPage);\n  event.currentTarget.reset();\n});\n\nloadMoreButton.addEventListener('click', () => {\n  currentPage += 1;\n  searchImages(searchQuery, currentPage);\n});"],"names":["formSearch","gallery","searchInput","loaderContainer","loadMoreButton","lightbox","SimpleLightbox","currentPage","perPage","searchQuery","showLoader","removeLoader","searchImages","query","BASE_URL","requestParams","searchParams","response","axios","hits","totalHits","iziToast","galleryHtml","html","image","scrollImages","error","event"],"mappings":"owBAMA,MAAMA,EAAa,SAAS,cAAc,cAAc,EAClDC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAc,SAAS,cAAc,sBAAsB,EAC3DC,EAAkB,SAAS,cAAc,mBAAmB,EAC5DC,EAAiB,SAAS,cAAc,mBAAmB,EAC3DC,EAAW,IAAIC,EAAe,aAAc,CAAE,aAAc,MAAO,aAAc,GAAG,CAAE,EAG5F,IAAIC,EAAc,EAClB,MAAMC,EAAU,GAChB,IAAIC,EAAc,GAElB,SAASC,GAAa,CACpBP,EAAgB,MAAM,QAAU,OAClC,CACA,SAASQ,GAAe,CACtBR,EAAgB,MAAM,QAAU,MAClC,CAEA,eAAeS,EAAaC,EAAON,EAAa,CAChD,MAAMO,EAAW,2BAGTC,EAAgB,CACpB,IAHY,qCAIZ,EAAGN,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMF,EACN,SAAUC,CACd,EAEQQ,EAAe,IAAI,gBAAgBD,CAAa,EAEtDL,IAEF,GAAI,CACJ,MAAMO,EAAW,MAAMC,EAAM,IAAI,GAAGJ,KAAYE,GAAc,EAExD,CAAE,KAAAG,EAAM,UAAAC,GAAcH,EAAS,KACrC,GAAIE,EAAK,SAAW,EAAG,CACrBf,EAAe,MAAM,QAAU,OAC/BiB,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,wCACT,SAAU,UACd,CAAG,EACD,MACF,CAEA,MAAMC,EAAcH,EAAK,OACnB,CAACI,EAAMC,IACLD,EACA,iCAAiCC,EAAM;AAAA;AAAA;AAAA,uBAGxBA,EAAM;AAAA,uBACNA,EAAM;AAAA;AAAA;AAAA;AAAA;AAAA,0CAKaA,EAAM;AAAA;AAAA;AAAA;AAAA,0CAINA,EAAM;AAAA;AAAA;AAAA;AAAA,0CAINA,EAAM;AAAA;AAAA;AAAA;AAAA,0CAINA,EAAM;AAAA;AAAA;AAAA,cAI1C,EACN,EAEIvB,EAAQ,mBAAmB,YAAaqB,CAAW,EAEnDjB,EAAS,QAAO,EAChBD,EAAe,MAAM,QAAU,QAE/B,MAAMqB,EAAe,SAClB,cAAc,eAAe,EAC7B,sBAAqB,EAAG,OAC3B,OAAO,SAAS,CACd,IAAKA,EAAe,EACpB,SAAU,QAChB,CAAK,EACGlB,EAAcC,GAAWY,IAC3BhB,EAAe,MAAM,QAAU,OAC/BiB,EAAS,MAAM,CACb,MAAO,QACP,QAAS,6DACT,SAAU,UAClB,CAAO,EAEJ,OAEMK,EAAP,CACEL,EAAS,MAAM,CACb,MAAO,QACP,QAASK,EAAM,QACf,SAAU,UAChB,CAAK,CACF,QACO,CACNf,GACD,CACH,CAEAX,EAAW,iBAAiB,SAAU2B,GAAS,CAC7CA,EAAM,eAAc,EACpB1B,EAAQ,UAAY,GACpBQ,EAAcP,EAAY,MAAM,OAChCK,EAAc,EACdH,EAAe,MAAM,QAAU,OAC/BQ,EAAaH,EAAaF,CAAW,EACrCoB,EAAM,cAAc,OACtB,CAAC,EAEDvB,EAAe,iBAAiB,QAAS,IAAM,CAC7CG,GAAe,EACfK,EAAaH,EAAaF,CAAW,CACvC,CAAC"}