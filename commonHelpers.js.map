{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst formSearch = document.querySelector('.form-search');\nconst listImages = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst btnLoad = document.querySelector('.btn');\nconst lightbox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 });\n\nlet page = 1;\nlet limit = 40;\n\nformSearch.addEventListener('submit', onSearch);\n\nasync function onSearch(event) {\n    event.preventDefault();\n    listImages.innerHTML = \" \";\n    const inputValue = event.target.elements.search.value;\n    loader.style.display = 'block';\n\n    try {\n        const picture = await getPictures(inputValue);\n        const totalPages = Math.ceil(picture.totalHits / limit);\n\n        if (page > totalPages) {\n            loader.style.display = 'none';\n            return iziToast.error({\n                position: \"topRight\",\n                message: \"We're sorry, but you've reached the end of search results\"\n            });\n        }\n\n        createGalleryMarkup(picture);\n\n        page += 1;\n\n        if (page > 1) {\n            btnLoad.textContent = 'Loading images, please wait...';\n        }\n        lightbox.refresh();\n    } catch (error) {\n        loader.style.display = 'none';\n        console.log(error);\n    }\n    formSearch.reset();\n}\n\nasync function getPictures(name) {\n    const BASE_URL = 'https://pixabay.com/api/';\n    const KEY = '41511305-1e730bfa7be67778e89c40f75';\n\n    const searchParams = new URLSearchParams({\n        key: KEY,\n        q: name,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: limit,\n        page: page\n    });\n\n    const response = await axios.get(`${BASE_URL}?${searchParams}`);\n\n    return response.data;\n}\n\nfunction createGalleryMarkup(picture) {\n    const markup = picture\n        .hits\n        .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n            `<li class=\"gallery-item\">\n              <a class=\"gallery-link\" href=\"${largeImageURL}\">\n                <img\n                  class=\"gallery-image\"\n                  src=\"${webformatURL}\"\n                  alt=\"${tags}\"\n                  width=\"360\"\n                />\n              </a>\n              <div class=\"thumb-block\">\n                <div class=\"block\">\n                  <h2 class=\"tittle\">Likes</h2>\n                  <p class=\"amount\">${likes}</p>\n                </div>\n                <div class=\"block\">\n                  <h2 class=\"tittle\">Views</h2>\n                  <p class=\"amount\">${views}</p>\n                </div>\n                <div class=\"block\">\n                  <h2 class=\"tittle\">Comments</h2>\n                  <p class=\"amount\">${comments}</p>\n                </div>\n                <div class=\"block\">\n                  <h2 class=\"tittle\">Downloads</h2>\n                  <p class=\"amount\">${downloads}</p>\n                </div>\n              </div>\n            </li>`)\n        .join('');\n    listImages.insertAdjacentHTML('beforeend', markup);\n}\n"],"names":["formSearch","listImages","loader","btnLoad","lightbox","SimpleLightbox","page","limit","onSearch","event","inputValue","picture","getPictures","totalPages","iziToast","createGalleryMarkup","error","name","BASE_URL","KEY","searchParams","axios","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"owBAMA,MAAMA,EAAa,SAAS,cAAc,cAAc,EAClDC,EAAa,SAAS,cAAc,UAAU,EAC9CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAU,SAAS,cAAc,MAAM,EACvCC,EAAW,IAAIC,EAAe,aAAc,CAAE,aAAc,MAAO,aAAc,GAAG,CAAE,EAE5F,IAAIC,EAAO,EACPC,EAAQ,GAEZP,EAAW,iBAAiB,SAAUQ,CAAQ,EAE9C,eAAeA,EAASC,EAAO,CAC3BA,EAAM,eAAc,EACpBR,EAAW,UAAY,IACvB,MAAMS,EAAaD,EAAM,OAAO,SAAS,OAAO,MAChDP,EAAO,MAAM,QAAU,QAEvB,GAAI,CACA,MAAMS,EAAU,MAAMC,EAAYF,CAAU,EACtCG,EAAa,KAAK,KAAKF,EAAQ,UAAYJ,CAAK,EAEtD,GAAID,EAAOO,EACP,OAAAX,EAAO,MAAM,QAAU,OAChBY,EAAS,MAAM,CAClB,SAAU,WACV,QAAS,2DACzB,CAAa,EAGLC,EAAoBJ,CAAO,EAE3BL,GAAQ,EAEJA,EAAO,IACPH,EAAQ,YAAc,kCAE1BC,EAAS,QAAO,CACnB,OAAQY,EAAP,CACEd,EAAO,MAAM,QAAU,OACvB,QAAQ,IAAIc,CAAK,CACpB,CACDhB,EAAW,MAAK,CACpB,CAEA,eAAeY,EAAYK,EAAM,CAC7B,MAAMC,EAAW,2BACXC,EAAM,qCAENC,EAAe,IAAI,gBAAgB,CACrC,IAAKD,EACL,EAAGF,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUV,EACV,KAAMD,CACd,CAAK,EAID,OAFiB,MAAMe,EAAM,IAAI,GAAGH,KAAYE,GAAc,GAE9C,IACpB,CAEA,SAASL,EAAoBJ,EAAS,CAClC,MAAMW,EAASX,EACV,KACA,IAAI,CAAC,CAAE,aAAAY,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAC1E;AAAA,8CACkCL;AAAA;AAAA;AAAA,yBAGrBD;AAAA,yBACAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sCAOaC;AAAA;AAAA;AAAA;AAAA,sCAIAC;AAAA;AAAA;AAAA;AAAA,sCAIAC;AAAA;AAAA;AAAA;AAAA,sCAIAC;AAAA;AAAA;AAAA,kBAGpB,EACT,KAAK,EAAE,EACZ5B,EAAW,mBAAmB,YAAaqB,CAAM,CACrD"}